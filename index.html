<script src="https://cdn.jsdelivr.net/npm/sweetalert2@7.12.15/dist/sweetalert2.all.min.js"></script>
<script>
  const scriptURL = "https://script.google.com/macros/s/AKfycbwAEOkH-iso4D9jHr41Uj7JeyUK8h037JwXiLc9qtj7_5dDPD3QlE8-B9t3fx4Qo88Q/exec";
  const form = document.getElementById("formulario");

  form.addEventListener("submit", (e) => {
    e.preventDefault();

    const formData = new FormData(form);

    // Añadir los campos "otro" si aplican
    const cuota = form.querySelector('select[name="cuota_mensual"]').value;
    if (cuota === "otro") {
      formData.set("cuota_mensual", form.querySelector('textarea[name="cuota_otro"]').value || "Otro");
    }

    const categoria = form.querySelector('select[name="categoria"]').value;
    if (categoria === "otro") {
      formData.set("categoria", form.querySelector('textarea[name="categoria_otro"]').value || "Otro");
    }

    // Combinar checkboxes seleccionadas
    const funcionalidades = [...form.querySelectorAll('input[name="funcionalidades"]:checked')]
      .map(i => i.value)
      .join(', ');
    formData.set("funcionalidades", funcionalidades);

    // Agregar "func_otro" si fue completado
    const func_otro = form.querySelector('textarea[name="func_otro"]').value;
    if (func_otro) {
      formData.set("funcionalidades", funcionalidades + ", " + func_otro);
    }

    fetch(scriptURL, {
      method: "POST",
      body: formData,
    })
    .then(() => {
      swal("¡Enviado!", "Tu información ha sido registrada con éxito.", "success");
      form.reset();
      document.querySelectorAll(".otro-especifique").forEach(div => div.classList.add("hidden"));
    })
    .catch((error) => {
      console.error("Error al enviar el formulario:", error);
      swal("Oops", "Ocurrió un error. Intenta de nuevo más tarde.", "error");
    });
  });
</script>

